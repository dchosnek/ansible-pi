---
- name: Install ufw package
  ansible.builtin.apt:
    name: ufw
    state: present

- name: Reject all traffic and allow SSH
  community.general.ufw:
    default: reject
    state: enabled
    rule: allow
    name: OpenSSH

- name: Allow specified app if app var is defined
  community.general.ufw:
    rule: allow
    name: "{{ item }}"
  # if app_list is undefined, enable OpenSSH again
  loop: "{{ app_list | default([OpenSSH]) }}"
