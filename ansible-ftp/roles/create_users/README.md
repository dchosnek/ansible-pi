# Ansible create_users role

This role creates one or more local users with a password and home directory. 

## Variables

The list of users can be supplied as a variables file (shown below) or inline in the playbook.

```bash
ansible-playbook ... -e "@sample_user.yml"
```

The role expects a list of users, so it must follow this format even if the list contains only one user:

```yaml
---
user_list:
  - name: myuser1
    password: mybadpassword
  - name: myuser2
    password: reallybadpassword
```

## Passwords

The Ansible module `ansible.builtin.user` expects the password field to be hashed with a salt that is also sent to the host. The value of the `password` field will actually look something like this:

```
$6$rounds=656000$mysecretsalt$.eNM1ZJfq/ia987d11Zo4PGvKRbL7zwWqsxKBpLGGtTmt8bqmWECBvMYHW8grUoSYqkuFLLQjyWzti3fUvMKy/
```

The above was created with the following code that takes the password `mypassword` and hashes it with the salt `mysecretsalt` using sha512.

```
{{ 'mypassword' | password_hash('sha512', 'mysecretsalt') }}
```

In this role, the salt is a 16-character randomly generated pattern. A random salt will be created for each user to improve security. This is done by replacing `mysecretsalt` in the command above with the following:

```
lookup('password', '/dev/null chars=ascii_lowercase,ascii_uppercase,digits length=16')
```

At the risk of sounding pedantic, this is really a **pseudo**-random salt since it is generated by a computer.
